!function(e){let t=0;const n={tableSelectorId:"treeTable",searchContainerId:null,showToggleAllButton:!0,highlightSearchMatches:!0,searchHighlightColor:"#ffff8b",searchMaxLevel:null,toggleColumnIndex:0,startExpanded:!1,rememberState:!1,classes:{searchInput:"pe-5",searchWrapper:"mb-3 position-relative",searchWrapperStyle:"max-width:400px;",resetBtn:"btn-sm position-absolute top-50 end-0 translate-middle-y me-2 d-none",noResults:"alert alert-warning small d-none mt-2",toggleRowBtn:"btn-primary btn-sm",toggleAllBtn:"btn-outline-secondary btn-sm"},iconClasses:{toggleRowOpen:"fa-solid fa-chevron-right fa-fw",toggleRowClose:"fa-solid fa-chevron-up fa-fw",toggleAllOpen:"fa-solid fa-plus fa-fw",toggleAllClose:"fa-solid fa-minus fa-fw",reset:"fa-solid fa-xmark"},i18n:{searchPlaceholder:"In allen Ebenen suchen...",searchResetAria:"ZurÃ¼cksetzen",toggleAllBtnTitle:"Alle ein-/ausklappen",noResults:"Keine Ergebnisse gefunden"}};function r(e,t){const n={...e};for(const s in t||{})"object"!=typeof t[s]||null===t[s]||Array.isArray(t[s])?n[s]=t[s]:n[s]=r(e[s]||{},t[s]);return n}function s(e,t,n,r){if(!e)return;const s=String(t||"").trim().split(/\s+/).filter(Boolean),l=String(n||"").trim().split(/\s+/).filter(Boolean);e.classList.remove(...s,...l),e.classList.add(...r?l:s)}e.BootstrapTreeTable={init:function(e={}){const l=r(n,e),o=l.tableSelectorId.startsWith("#")?l.tableSelectorId:"#"+l.tableSelectorId,a=document.querySelector(o);if(!a)return;const i=++t,c=Array.from(a.querySelectorAll("tr")),u=`btt-state:${l.tableSelectorId}:${i}`;function d(e){const t=Array.from(e.classList).find((e=>e.startsWith("level-")));return t?parseInt(t.replace("level-",""),10):0}function f(e){return e.closest("tbody")&&Array.from(e.classList).some((e=>e.startsWith("level-")))}function g(e,t){e.dataset.visible=t?"true":"false",e.style.display=t?"":"none"}let p,b,h=null;if(l.showToggleAllButton){const e=a.querySelector("thead tr th");if(e&&!e.querySelector("#toggleAll"+i)){const t=document.createElement("button");t.id="toggleAll"+i,t.className="btn "+(l.classes.toggleAllBtn||""),t.title=l.i18n.toggleAllBtnTitle,t.innerHTML=`<i id="toggleAllIcon${i}" class="${l.iconClasses.toggleAllOpen}"></i>`,e.appendChild(t)}h=document.getElementById("toggleAll"+i)}const m="tableSearch"+i,y="resetSearch"+i,A=l.searchContainerId?l.searchContainerId.startsWith("#")?l.searchContainerId.slice(1):l.searchContainerId:null;if(A&&document.getElementById(A)){if(!document.getElementById(m)){const e=document.createElement("div");e.className="position-relative "+(l.classes.searchWrapper||""),e.style.cssText=l.classes.searchWrapperStyle||"",e.innerHTML=`\n          <input type="text" id="${m}" class="form-control ${l.classes.searchInput||""}" placeholder="${l.i18n.searchPlaceholder}"/>\n          <button id="${y}" type="button" class="btn ${l.classes.resetBtn||""}" style="z-index:2" aria-label="${l.i18n.searchResetAria}">\n            <i class="${l.iconClasses.reset}"></i>\n          </button>\n        `,document.getElementById(A).appendChild(e)}p=document.getElementById(m),b=document.getElementById(y)}const E="tableSearchEmpty"+i;if(!document.getElementById(E)){const e=document.createElement("div");e.id=E,e.className="table-search-empty "+(l.classes.noResults||""),e.textContent=l.i18n.noResults,a.after(e)}const S=document.getElementById(E);function v(){c.forEach(((e,t)=>{if(!f(e)||!function(e,t){const n=d(e),r=c[t+1];return!!(r&&d(r)>n)}(e,t))return;const n=e.cells[l.toggleColumnIndex]||e.cells[0];if(n&&!n.querySelector(".toggle-row-btn")){const e=document.createElement("button");e.type="button",e.className="btn toggle-row-btn "+(l.classes.toggleRowBtn||""),e.setAttribute("data-open","false"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Toggle row"),e.innerHTML=`<i class="${l.iconClasses.toggleRowClose}"></i>`;const t=document.createElement("span");for(;n.firstChild;)t.appendChild(n.firstChild);n.appendChild(e),n.appendChild(t),n.style.whiteSpace="nowrap",n.classList.add("btt-cell")}}))}function w(){return c.some((e=>f(e)&&d(e)>0&&"true"===e.dataset.visible))}function L(){const e=document.getElementById("toggleAllIcon"+i);if(!e)return;const t=w();s(e,l.iconClasses.toggleAllOpen,l.iconClasses.toggleAllClose,t)}function C(e,t){const n=e.querySelector("[data-fa-i2svg], i, svg");n&&s(n,l.iconClasses.toggleRowOpen,l.iconClasses.toggleRowClose,t)}function x(){c.forEach(((e,t)=>{if(!f(e))return;const n=e.querySelector(".toggle-row-btn");if(!n)return;const r=d(e);let s=!1;for(let e=t+1;e<c.length;e++){const t=c[e];if(!f(t))continue;const n=d(t);if(n<=r)break;if(n===r+1&&"true"===t.dataset.visible){s=!0;break}}n.setAttribute("data-open",s?"true":"false"),n.classList.toggle("open",s),n.setAttribute("aria-expanded",s?"true":"false"),C(n,s)}))}function I(){c.forEach((e=>{f(e)&&function(e){Array.from(e.cells).forEach((e=>{const t=e.getAttribute("data-orig-html");null!==t&&(e.innerHTML=t)}))}(e)}))}function B(e){I();const t=e.trim(),n="number"==typeof l.searchMaxLevel?l.searchMaxLevel:null;if(!t)return c.forEach((e=>{if(!f(e))return;const t=0===d(e),n=l.startExpanded||t;g(e,n);const r=e.querySelector(".toggle-row-btn");if(r){const e=n&&!t;r.setAttribute("data-open",e?"true":"false"),r.classList.toggle("open",e),r.setAttribute("aria-expanded",e?"true":"false")}})),v(),x(),L(),b&&b.classList.add("d-none"),S&&S.classList.add("d-none"),void T();let r=[];c.forEach((e=>{if(!f(e))return;const s=d(e);if(null!==n&&s>n)return void g(e,!1);let o=!1;Array.from(e.cells).forEach((e=>{const n=e.getAttribute("data-orig-html")??e.innerHTML;if(!n)return;(e.textContent||"").toLowerCase().includes(t.toLowerCase())&&(e.innerHTML=function(e,t){if(!l.highlightSearchMatches||!t)return e;const n=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig");return e.replace(n,(e=>`<mark style="background:${l.searchHighlightColor};padding:0 2px;border-radius:2px">${e}</mark>`))}(n,t),o=!0)})),g(e,o),o&&r.push(e)})),r.forEach((e=>function(e){let t=d(e);for(let n=c.indexOf(e)-1;n>=0;n--){let e=c[n];if(!f(e))continue;let r=d(e);if(r<t){g(e,!0);let n=e.querySelector(".toggle-row-btn");n&&(n.setAttribute("data-open","true"),n.classList.add("open"),n.setAttribute("aria-expanded","true")),t=r}if(0===r)break}}(e))),v(),x(),L();const s=c.some((e=>f(e)&&"true"===e.dataset.visible));S&&(s?S.classList.add("d-none"):S.classList.remove("d-none")),b&&b.classList.remove("d-none")}function T(){if(!l.rememberState)return;const e=c.filter((e=>f(e))).map((e=>({idx:c.indexOf(e),visible:"true"===e.dataset.visible,open:!!e.querySelector(".toggle-row-btn")&&e.querySelector(".toggle-row-btn").classList.contains("open")})));try{localStorage.setItem(u,JSON.stringify(e))}catch(e){}}c.forEach((e=>{f(e)&&Array.from(e.cells).forEach((e=>{e.hasAttribute("data-orig-html")||e.setAttribute("data-orig-html",e.innerHTML)}))})),c.forEach((e=>{if(!f(e))return;const t=0===d(e);g(e,l.startExpanded||t)})),v(),function(){if(!l.rememberState)return!1;try{const e=localStorage.getItem(u);if(!e)return!1;const t=JSON.parse(e);return!!Array.isArray(t)&&(t.forEach((e=>{const t=c[e.idx];if(!t||!f(t))return;g(t,!!e.visible);const n=t.querySelector(".toggle-row-btn");n&&(n.classList.toggle("open",!!e.open),n.setAttribute("data-open",e.open?"true":"false"),n.setAttribute("aria-expanded",e.open?"true":"false"))})),x(),L(),!0)}catch(e){return!1}}()||(x(),L()),a.addEventListener("click",(function(e){const t=e.target.closest(".toggle-row-btn");if(!t)return;!function(e,t){const n=d(e);let r=!1;for(const s of c){if(s===e){r=!0;continue}if(!r||!f(s))continue;const l=d(s);if(l<=n)break;if(t)l===n+1&&g(s,!0);else{g(s,!1);const e=s.querySelector(".toggle-row-btn");e&&(e.setAttribute("data-open","false"),e.classList.remove("open"),e.setAttribute("aria-expanded","false"))}}const s=e.querySelector(".toggle-row-btn");s&&(s.setAttribute("data-open",t?"true":"false"),s.classList.toggle("open",t),s.setAttribute("aria-expanded",t?"true":"false"),C(s,t)),x(),L(),T()}(t.closest("tr"),"true"!==t.getAttribute("data-open"))})),h&&h.addEventListener("click",(function(){p&&""!==p.value&&(p.value="",B("")),w()?(c.forEach((e=>{if(!f(e))return;g(e,0===d(e));const t=e.querySelector(".toggle-row-btn");t&&(t.setAttribute("data-open","false"),t.classList.remove("open"),t.setAttribute("aria-expanded","false"))})),x(),L(),T()):(c.forEach((e=>{f(e)&&g(e,!0)})),x(),L(),T())})),p&&b&&(p.addEventListener("input",function(e,t=200){let n;return(...r)=>{clearTimeout(n),n=setTimeout((()=>e(...r)),t)}}((e=>B(e.target.value)))),b.addEventListener("click",(()=>{p.value="",B("")})))}}}(window);